<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulador de Comiss√£o Real TVDE</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6f8;
      color: #333;
      padding: 20px;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 30px;
    }
    h1 {
      text-align: center;
      color: #d93025;
      margin-bottom: 10px;
    }
    h2 {
      text-align: center;
      font-weight: normal;
      color: #555;
      margin-bottom: 30px;
    }
    .input-group {
      margin-bottom: 15px;
    }
    .input-group label {
      display: block;
      font-weight: bold;
      margin-bottom: 6px;
    }
    .input-group input, .input-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 15px;
    }
    .btn {
      background: #d93025;
      color: #fff;
      border: none;
      padding: 10px 18px;
      font-size: 15px;
      border-radius: 8px;
      cursor: pointer;
      margin-right: 10px;
      margin-top: 10px;
    }
    .btn:hover {
      background: #b71c1c;
    }
    .resultado {
      margin-top: 25px;
      padding: 15px;
      background: #ffe9e9;
      border-left: 5px solid #d93025;
      border-radius: 8px;
      font-size: 16px;
      line-height: 1.5;
    }
    footer {
      margin-top: 50px;
      text-align: center;
      font-size: 14px;
      color: #777;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöó Quanto Te Cobram Realmente?</h1>
    <h2>Simulador de Comiss√£o Real para Motoristas TVDE</h2>

    <div class="input-group">
      <label for="valorTotal">Valor total da viagem (‚Ç¨)</label>
      <input type="number" id="valorTotal" placeholder="Ex: 10.00">
    </div>

    <div class="input-group">
      <label for="valorRecebido">Valor recebido pelo motorista (‚Ç¨)</label>
      <input type="number" id="valorRecebido" placeholder="Ex: 7.20">
    </div>

    <div class="input-group">
      <label for="tipoViagem">Tipo de viagem (opcional)</label>
      <select id="tipoViagem">
        <option value="">‚Äî</option>
        <option value="curta">Curta</option>
        <option value="longa">Longa</option>
        <option value="aeroporto">Aeroporto</option>
      </select>
    </div>

    <button class="btn" onclick="calcularComissao()">Calcular Comiss√£o</button>
    <button class="btn" onclick="exportarPDF()">üìÑ Exportar para PDF</button>

    <div class="resultado" id="resultado"></div>
  </div>

  <footer>
    Desenvolvido por DriveAI ‚Äî Transpar√™ncia para motoristas TVDE
  </footer>

  <script>
    function calcularComissao() {
      const valorTotal = parseFloat(document.getElementById('valorTotal')?.value) || 0;
      const valorRecebido = parseFloat(document.getElementById('valorRecebido')?.value) || 0;
      const tipoViagem = document.getElementById('tipoViagem')?.value;

      const comissao = valorTotal > 0 ? ((valorTotal - valorRecebido) / valorTotal) * 100 : 0;
      const comissaoFormatada = comissao.toFixed(2);

      const comissaoAnunciada = 25;
      const diferenca = comissao - comissaoAnunciada;
      const diferencaFormatada = diferenca.toFixed(2);

      let alerta = '';
      if (comissao > comissaoAnunciada) {
        alerta = `‚ö†Ô∏è Aten√ß√£o: A comiss√£o ultrapassa o valor prometido pela plataforma.`;
      }

      let observacao = '';
      if (tipoViagem === 'curta') {
        observacao = "üì¢ Viagens curtas costumam ter comiss√µes mais altas devido a taxas m√≠nimas.";
      } else if (tipoViagem === 'aeroporto') {
        observacao = "üì¢ Viagens de aeroporto podem incluir taxas adicionais.";
      }

      document.getElementById('resultado').innerHTML = `
        üí∏ <strong>Comiss√£o aplicada:</strong> ${comissaoFormatada}%<br>
        üìâ <strong>Diferen√ßa em rela√ß√£o √† comiss√£o anunciada (25%):</strong> ${diferenca > 0 ? '+' : ''}${diferencaFormatada}%<br>
        ${alerta ? `<br>${alerta}` : ''}
        ${observacao ? `<br>${observacao}` : ''}
      `;
    }

    async function exportarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const valorTotal = parseFloat(document.getElementById('valorTotal')?.value) || 0;
      const valorRecebido = parseFloat(document.getElementById('valorRecebido')?.value) || 0;
      const tipoViagem = document.getElementById('tipoViagem')?.value || '‚Äî';

      const comissao = valorTotal > 0 ? ((valorTotal - valorRecebido) / valorTotal) * 100 : 0;
      const comissaoFormatada = comissao.toFixed(2);
      const comissaoAnunciada = 25;
      const diferenca = comissao - comissaoAnunciada;
      const diferencaFormatada = diferenca.toFixed(2);

      let alerta = '';
      if (comissao > comissaoAnunciada) {
        alerta = "Aten√ß√£o: A comiss√£o ultrapassa o valor prometido pela plataforma.";
      }

      let observacao = '';
      if (tipoViagem === 'curta') {
        observacao = "Viagens curtas costumam ter comiss√µes mais altas devido a taxas m√≠nimas.";
      } else if (tipoViagem === 'aeroporto') {
        observacao = "Viagens de aeroporto podem incluir taxas adicionais.";
      }

      doc.setFontSize(14);
      doc.text("Simulador de Comiss√£o Real TVDE", 20, 20);
      doc.setFontSize(12);
      doc.text("üìã Dados inseridos:", 20, 30);

      let y = 36;
      doc.text(`Valor total da viagem: ‚Ç¨${valorTotal.toFixed(2)}`, 20, y); y += 6;
      doc.text(`Valor recebido pelo motorista: ‚Ç¨${valorRecebido.toFixed(2)}`, 20, y); y += 6;
      doc.text(`Tipo de viagem: ${tipoViagem}`, 20, y); y += 10;

      doc.text("üìä Resultados:", 20, y); y += 6;
      doc.text(`Comiss√£o aplicada: ${comissaoFormatada}%`, 20, y); y += 6;
      doc.text(`Diferen√ßa em rela√ß√£o √† comiss√£o anunciada (25%): ${diferenca > 0 ? '+' : ''}${diferencaFormatada}%`, 20, y); y += 6;

      if (alerta) {
        const alertaTexto = doc.splitTextToSize(alerta, 170);
        doc.text(alertaTexto, 20, y); y += alertaTexto.length * 6;
      }

      if (observacao) {
        const obsTexto = doc.splitTextToSize(observacao, 170);
        doc.text(obsTexto, 20, y); y += obsTexto.length * 6;
      }

      doc.save("comissao-real-tvde.pdf");
    }
  </script>
</body>
</html>
